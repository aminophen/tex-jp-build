#! /bin/sh -vx
#
# Copyright 2022 TANAKA Takuji <ttk@t-lab.opal.ne.jp>
# You may freely use, modify and/or distribute this file.

test -d tests || mkdir -p tests

rc=0

TEXMFCNF=$srcdir/../kpathsea
BSTINPUTS=$srcdir/tests
BIBINPUTS=$srcdir/tests
export TEXMFCNF BSTINPUTS BIBINPUTS


## test for japanese bibtex style
#cp $srcdir/tests/unibibu-jplain.aux tests/xunibibu-jplain.aux
#./bibtexu tests/xunibibu-jplain || rc=1
#if [ $? -gt 1 ]; then rc=1; fi
#diff $srcdir/tests/unibibu-jplain.bbl tests/xunibibu-jplain.bbl || rc=2

for st in jplain jalpha jabbrv junsrt jname; do

cp $srcdir/tests/unibibu-$st.aux tests/xunibibu-$st.aux
./bibtexu tests/xunibibu-$st
if [ $? -gt 1 ]; then rc=1; fi
diff $srcdir/tests/unibibu-$st.bbl tests/xunibibu-$st.bbl || rc=2

done

exit $rc



