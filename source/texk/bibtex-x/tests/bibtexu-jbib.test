#! /bin/sh -vx
#
# Copyright 2022 TANAKA Takuji <ttk@t-lab.opal.ne.jp>
# You may freely use, modify and/or distribute this file.

test -d tests || mkdir -p tests

rc=0

TEXMFCNF=$srcdir/../kpathsea
BSTINPUTS=$srcdir/tests
BIBINPUTS=$srcdir/tests
export TEXMFCNF BSTINPUTS BIBINPUTS


## test for japanese bibtex style
#cp $srcdir/tests/mlgbibu-jplain.aux tests/xmlgbibu-jplain.aux
#./bibtexu tests/xmlgbibu-jplain || rc=1
#if [ $? -gt 1 ]; then rc=1; fi
#diff $srcdir/tests/mlgbibu-jplain.bbl tests/xmlgbibu-jplain.bbl || rc=2

for st in jplain jalpha jabbrv junsrt jname; do

cp $srcdir/tests/mlgbibu-$st.aux tests/xmlgbibu-$st.aux
./bibtexu tests/xmlgbibu-$st
if [ $? -gt 1 ]; then rc=1; fi
diff $srcdir/tests/mlgbibu-$st.bbl tests/xmlgbibu-$st.bbl || rc=2

done

exit $rc



