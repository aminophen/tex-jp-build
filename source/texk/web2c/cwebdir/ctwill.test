#! /bin/sh -vx
# $Id$
# Copyright 2023 Andreas Scherer <tex-live@tug.org>
# You may freely use, modify and/or distribute this file.

testdir=$srcdir/cwebdir/tests

#
# (1) Test the "classic" CTWILL procedure
#
# Prime the pump by running CTWILL twice
CWEBINPUTS=$testdir ./ctwill +lpdf ham ham || exit 1
CWEBINPUTS=$testdir ./ctwill +lpdf ham ham || exit 1

# Test CTWILL-REFSORT
./ctwill-refsort < $testdir/ham.ref > ham.sref || exit 1
diff ham.sref $testdir/ham.sref || exit 1

#
# (2) Test the "proofing" CTWILL procedure
#
CWEBINPUTS=$testdir ./ctwill +P +lpdf ham ham || exit 1
CWEBINPUTS=$testdir ./ctwill +P +lpdf ham ham || exit 1

# Test CTWILL-PROOFSORT---NOT!
# First, it doesn't show up in Work/texk/web2c/ and
# second, Perl complains about the unresolved $Revision$ and Â§Date$.
#./ctwill-proofsort ham.tex > ham-sorted.tex || exit 1
#diff ham-sorted.tex $testdir/ham-sorted.tex || exit 1

exit 0
